<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape Room VR - Aula</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@^3.0.3/dist/super-hands.min.js"></script>
    <script src="https://unpkg.com/aframe-super-keyboard/dist/aframe-super-keyboard.min.js"></script>
    <script src="common.js"></script>
</head>

<body>
    <a-scene stats="true" vr-mode-ui="enabled: false" renderer="antialias: true">
        <a-entity progressive-controls></a-entity>
        <!-- Assets -->
        <a-asset-item id="macbook" src="assets/modelli/macbook_psx_style.glb" preload="true"></a-asset-item>
        <a-asset-item id="classroom" src="assets/modelli/classroom_demoscene.glb" preload="true"></a-asset-item>
        <a-assets>
            <audio id="page-sound" src="assets/suoni/page1.mp3" preload="auto"></audio>
        </a-assets>

        <!--Setup ambiente-->

        <!-- Posizione modello nella scena -->
        <!-- Muri e pavimento -->
        <a-entity gltf-model="#classroom" position="0 0 0" scale="1 1 1"></a-entity>
        <!-- Lavagna -->
        <a-box position="0.31 1.52 4.78" scale="-0.16 1.14 4.7" color="green" opacity="0.5" class="clickable"
            onclick="goToArtRoom()" rotation="0.9330000000000002 90.43565838344914 0.4068000345428845"
            visible="false"></a-box>
        <!-- Orologio-->
        <a-box position="-0.2 2.81 4.77" scale="0.676 0.64605 0.23868" color="blue" opacity="0.5" class="clickable"
            onclick="goToChemLab()" visible="false"></a-box>
        <!-- PC -->
        <a-entity gltf-model="#macbook" position="0.7 0.86 0.00352" rotation="0 1.151 0" scale=""></a-entity>
        <!-- TV -->
        <!-- Telecamera -->
        <a-camera position="1.5 2 9">
            <a-cursor id="cursor" raycaster="objects: .clickable" color="#FF0000"></a-cursor>
            <a-entity id="timer" text="value: Tempo: 0m 0s; align: center; color: black" position="0 -0.5 -1.5"
                scale="1.5 1.5 1.5">
            </a-entity>
        </a-camera>
        <a-lod>
            <a-entity gltf-model="model_high_res.glb" distance="0 10"></a-entity> <!-- High resolution -->
            <a-entity gltf-model="model_low_res.glb" distance="10 50"></a-entity> <!-- Low resolution -->
        </a-lod>
        <!--Illuminazione scena -->
        <a-light type="ambient" color="#fff" intensity="1"></a-light>
        <a-sky color="#87CEFA"></a-sky>
        <!--Suono-->
        <a-entity sound="src: #page-sound; autoplay: true; loop: true"></a-entity>
        <!--Setup ambiente-->
    </a-scene>


    <!-- custom js -->
    <script>
        // Funzione per mostrare messaggi compatibili con VR e desktop
        function showMessageVR(message) {
            if (AFRAME.utils.device.isMobileVR()) {
                // Mostra il messaggio direttamente nel mondo VR
                var messageBox = document.createElement('a-text');
                messageBox.setAttribute('value', message);
                messageBox.setAttribute('position', '1.1 1 3.06');
                messageBox.setAttribute('align', 'center');
                messageBox.setAttribute('color', 'black');
                var scene = document.querySelector('a-scene');
                scene.appendChild(messageBox);


                setTimeout(() => {
                    scene.removeChild(messageBox);
                }, 3000);
            } else {
                // Mostra il messaggio come alert su desktop
                alert(message);
            }
        }

        //Suono
        function startAudio() {
            const musicEntity = document.querySelector('a-entity[sound]');
            musicEntity.components.sound.playSound();
        }


        //Funzione per andare alla stanza di arte
        function goToArtRoom() {
            window.location.href = 'artroom.html';
        }

        //Funzione per andare alla stanza di chimica
        function goToChemLab() {
            window.location.href = 'chemlab.html';
        }
    </script>

</body>

</html>
